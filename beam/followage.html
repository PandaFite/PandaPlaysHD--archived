<!DOCTYPE HTML>
<html lang="en">
	<head>
		<title>Followage - PandaPlaysHD</title>
		<meta charset="utf-8" />
        <link rel="shortcut icon" href="img/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="css/main.css" />
        <link rel="stylesheet" href="css/font-awesome.min.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
		<script src="js/jquery-3.1.0.min.js" type="text/javascript"></script>
	</head>
	<body class="single">
        <div class="loader" id="loader"></div>
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="https://beam.pro/pandaplayshd"><img src="img/logo.png" class="logoImg" />PandaPlaysHD</a></h1>
						<nav class="links">
							<ul>
								<li><a href="about">About</a></li>
                                <li>
                                    <a href="business/">Business</a>

                                    <ul>
                                        <li class="liExempt"></li>
                                        <br />
                                        <li><a href="business/server">Minecraft Server</a></li>
                                        <br />
                                        <li><a href="business/sponsor">Sponsorship</a></li>
                                    </ul>
                                </li>
								<li><a href="downloads">Downloads</a></li>
								<li><a href="specs">Specs</a></li>
								<li><a href="points">Points</a></li>
								<li><a href="rules">Rules</a></li>
								<li><a href="schedule">Schedule</a></li>
								<li><a href="social">Social</a></li>
								<li><a href="tips">Tips</a></li>
							</ul>
						</nav>
						<nav class="main">
							<ul>
								<li class="menu">
									<a class="fa-bars" href="#menu">Menu</a>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Menu -->
					<section id="menu">

							<section>
								<h3>Menu</h3>
							</section>

						<!-- Links -->
                        <section>
                            <ul class="links">
                                <li>
                                    <a href="about">
                                        <h3>About</h3>
                                        <p>About Panda</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="business/">
                                        <h3>Business</h3>
                                        <p>Business Inquiries</p>
                                    </a>
                                    <a href="business/server" class="subBusiness"> - Minecraft Server</a>
                                    <a href="business/sponsor" class="subBusiness"> - Sponsorship</a>
                                </li>
                                <li>
                                    <a href="downloads">
                                        <h3>Downloads</h3>
                                        <p>Skins &amp; Resource Packs</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="specs">
                                        <h3>Specs</h3>
                                        <p>Computer Information</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="points">
                                        <h3>Points</h3>
                                        <p>Chat Points System</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="rules">
                                        <h3>Rules</h3>
                                        <p>Stream Chat Rules</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="schedule">
                                        <h3>Schedule</h3>
                                        <p>Stream Times</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="social">
                                        <h3>Social</h3>
                                        <p>Panda's Social Media</p>
                                    </a>
                                </li>

                                <li>
                                    <a href="tips">
                                        <h3>Tips</h3>
                                        <p>Support Panda</p>
                                    </a>
                                </li>
                            </ul>
                        </section>

					</section>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2>Check Your Followage</h2>
									</div>
									<!--<div class="meta">
										<time class="published" datetime="2015-11-01">November 1, 2015</time>
										<a href="#" class="author"><span class="name">Jane Doe</span><img src="img/avatar.jpg" alt="" /></a>
									</div>-->
								</header>

								<div class="featured">
                                        <section>
                                            <input type="text" id="username" placeholder="Twitch Username" style="font-size: 14px; color: white; width: 180px; margin: auto;" autofocus> 
											<input id="followageButton" class="button" type="button" onclick="buttonClick()" style="display: block; margin-left: auto; margin-right: auto; font-size: 10px; margin-top: 5px; width: 180px;" value="Check Followage" />
											<p id="prefix" style="font-size: 1em; text-align: center"></p>
											<p id="result" style="font-size: 2em; text-align: center"></p>
                                        </section>
										<script type="text/javascript">
			var username;
			
			function buttonClick() {
				username = document.getElementById('username').value;
				if (username) {
					getFollowage(username);
					document.getElementById('result').innerHTML = "<img src='img/loading-bar.gif' class='nodrag' />";
				}				
			}						
										
			var usr = getAllUrlParams().u;
			if (usr) getFollowage(usr);
			
			function getFollowage(u){

			$.ajax({
			url: "https://api.rtainc.co/twitch/channels/PandaPlaysHD/followers/" + u + "?format=[2]",
			success: function (data) {
			
			var displayUsername;
			var userLogo;
			
			$.ajax({
			 type: 'GET',
			 url: 'https://api.twitch.tv/kraken/channels/' + u,
			 headers: {
			   'Client-ID': 'f2cmg4s30fnzmq7zbcx8rcsfxdc1san'
			 },
			 success: function(data) {
			   console.log(data);
					displayUsername = data.display_name;
					document.getElementById('username').value = data.display_name;
					if (!data.logo) {
					
					}
					else{
					userLogo = data.logo;
					}
					 },
					 error: function() {
						userLogo = "https://static-cdn.jtvnw.net/jtv_user_pictures/xarth/404_user_70x70.png";
					 }
					});
			if (u != "")
			{
				
			document.getElementById('result').innerHTML = "<img src='img/loading-bar.gif' class='nodrag' />";	
			setTimeout(function() {
			document.getElementById('prefix').innerHTML = 
			"<a href='https://www.twitch.tv/" + displayUsername + "' target='_blank'><img src='" + userLogo + "' height='30' width='30' class='nodrag' style='vertical-align: middle;' title='" + displayUsername + "' /></a> has been following Panda for";
			}, 500);	
			
			
			setTimeout(function() {
			document.getElementById('result').textContent = data;
			}, 2000);
			}
			else 
			{
			document.getElementById('prefix').textContent = "";
			document.getElementById('result').innerHTML = "<img src='img/loading-bar.gif' class='nodrag' />";
			
			setTimeout(function() {
			document.getElementById('result').textContent = "(error)";
			}, 2000);
			
			}
			
			
			
			},
			dataType: "html",
			error: function (data) {
			document.getElementById('prefix').textContent = "";
			document.getElementById('result').innerHTML = "<img src='img/loading-bar.gif' class='nodrag' />";
			
			setTimeout(function() {
			document.getElementById('result').textContent = "(error)";
			}, 2000);}
			});
			}
			
			$("#username").keyup(function(event){
			if(event.keyCode == 13){
			$("#followageButton").click();
			}
			});
			
			
			
			
			function getAllUrlParams(url) {

			  // get query string from url (optional) or window
			  var queryString = url ? url.split('?')[1] : window.location.search.slice(1);

			  // we'll store the parameters here
			  var obj = {};

			  // if query string exists
			  if (queryString) {

				// stuff after # is not part of query string, so get rid of it
				queryString = queryString.split('#')[0];

				// split our query string into its component parts
				var arr = queryString.split('&');

				for (var i=0; i<arr.length; i++) {
				  // separate the keys and the values
				  var a = arr[i].split('=');

				  // in case params look like: list[]=thing1&list[]=thing2
				  var paramNum = undefined;
				  var paramName = a[0].replace(/\[\d*\]/, function(v) {
					paramNum = v.slice(1,-1);
					return '';
				  });

				  // set parameter value (use 'true' if empty)
				  var paramValue = typeof(a[1])==='undefined' ? true : a[1];

				  // (optional) keep case consistent
				  paramName = paramName.toLowerCase();
				  paramValue = paramValue.toLowerCase();

				  // if parameter name already exists
				  if (obj[paramName]) {
					// convert value to array (if still string)
					if (typeof obj[paramName] === 'string') {
					  obj[paramName] = [obj[paramName]];
					}
					// if no array index number specified...
					if (typeof paramNum === 'undefined') {
					  // put the value on the end of the array
					  obj[paramName].push(paramValue);
					}
					// if array index number specified...
					else {
					  // put the value at that index number
					  obj[paramName][paramNum] = paramValue;
					}
				  }
				  // if param name doesn't exist yet, set it
				  else {
					obj[paramName] = paramValue;
				  }
				}
			  }

			  return obj;
			}
			
			setTimeout ( function () {
			var user = getAllUrlParams().u;
			var chan = getAllUrlParams().c;
			
			if (user) {
			document.getElementById('username').value = user;
			}
			
			if (chan) {
			document.getElementById('channelName').value = chan;
			}
			
			if (chan && user) {
			getFollowage();
			}
			
			}, 0);

			</script>
                                </div>

							</article>

					</div>

				<!-- Footer -->
					<section id="footer">
                        <ul class="icons">
                            <li><a href="https://twitter.com/pandaplayshd" class="fa-twitter"><span class="label">Twitter</span></a></li>
                            <li><a href="https://www.youtube.com/user/pandaplaysmchd" class="fa-youtube-play"><span class="label">YouTube</span></a></li>
                            <li><a href="https://instagram.com/pandaplayshd" class="fa-instagram"><span class="label">Instagram</span></a></li>
                            <li><a href="https://www.snapchat.com/add/PandaPlaysHD" class="fa-snapchat"><span class="label">Snapchat</span></a></li>
                            <li><a href="mailto:contact@pandaplayshd.ml" class="fa-envelope"><span class="label">Email</span></a></li>
                        </ul>
						<p class="copyright">Copyright &copy; PandaPlaysHD 2015-2017. Developed by: <a href="https://mattunderscore.us">mattunderscore</a>. Designed by: <a href="http://html5up.net">HTML5 UP</a>.</p>
					</section>

			</div>

		<!-- Scripts -->
			<script src="js/jquery.min.js"></script>
            <script src="js/jquery.dropotron.min.js"></script>
			<script src="js/skel.min.js"></script>
			<script src="js/util.js"></script>
			<!--[if lte IE 8]><script src="js/ie/respond.min.js"></script><![endif]-->
			<script src="js/main.js"></script>
	</body>
</html>
